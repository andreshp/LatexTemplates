%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Paquete con un estilo para el título de la plantilla básica.
%
% Autor: Andrés Herrera Poyatos (https://github.com/andreshp) 
%
% La idea original ha sido obtenida del siguiente enlace:
%
% http://tex.stackexchange.com/questions/85904/showcase-of-beautiful-title-page-done-in-tex
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ProvidesPackage{title1}[2016]

% Paquetes que requiere el título.
\usepackage{graphicx}
\usepackage{ifthen}
\usepackage{tikz}

% Color para el dibujo.
\definecolor{titlepagecolor}{cmyk}{1,.60,0,.40}

% Fuentes del documento.
\DeclareFixedFont{\subjectfont}{\encodingdefault}{ppl}{b}{it}{0.5in}
\DeclareFixedFont{\titlefont}{\encodingdefault}{ppl}{b}{it}{0.5in}
\DeclareFixedFont{\subtitlefont}{\encodingdefault}{ppl}{b}{it}{0.3in}

% Comando para mostrar el autor y su información asociada.
\newcommand{\titlepageauthor}{
	\begin{flushright}
		\begin{minipage}{0.4\linewidth}
			\Large\textbf{\docauthor}
			
			\centering \large\docaddress
			
			\centering \large{\color{titlepagecolor}\docemail}
		\end{minipage}
		\begin{minipage}{0.02\linewidth}
			\rule{1pt}{125pt}
		\end{minipage}
	\end{flushright}
}

% Comando para mostrar el resumen y el autor.
\newcommand{\titlepageabstractauthor}{
	\begin{minipage}{0.5\linewidth}
		\begin{abstract} 
			\docabstract
		\end{abstract}
	\end{minipage}
	\begin{minipage}{0.02\linewidth}
		\rule{1pt}{125pt}
	\end{minipage}\hspace{0.5cm}
	\begin{minipage}{0.4\linewidth}
		\Large\textbf{\docauthor}
		
		\centering \large\docaddress
		
		\centering \large{\color{titlepagecolor}\docemail}
	\end{minipage}
}


% Comando para presentar el resumen y el autor en función de si el primero está vacío o no.
\newcommand{\titlepagebottom}{
	\ifthenelse{\equal{\docabstract}{}}{\titlepageauthor}{\titlepageabstractauthor}
}


% El siguiente código ha sido tomado de:
% http://tex.stackexchange.com/a/86310/10898
% Permite hacer el dibujo con tikz.
\newcommand\titlepagedecoration{
	\begin{tikzpicture}[remember picture,overlay,shorten >= -10pt]
	
		\coordinate (aux1) at ([yshift=-15pt]current page.north east);
		\coordinate (aux2) at ([yshift=-410pt]current page.north east);
		\coordinate (aux3) at ([xshift=-4.5cm]current page.north east);
		\coordinate (aux4) at ([yshift=-150pt]current page.north east);
		
		\begin{scope}[titlepagecolor!40,line width=12pt,rounded corners=12pt]
			\draw
			(aux1) -- coordinate (a)
			++(225:5) --
			++(-45:5.1) coordinate (b);
			\draw[shorten <= -10pt]
			(aux3) --
			(a) --
			(aux1);
			\draw[opacity=0.6,titlepagecolor,shorten <= -10pt]
			(b) --
			++(225:2.2) --
			++(-45:2.2);
		\end{scope}
		\draw[titlepagecolor,line width=8pt,rounded corners=8pt,shorten <= -10pt]
		(aux4) --
		++(225:0.8) --
		++(-45:0.8);
		\begin{scope}[titlepagecolor!70,line width=6pt,rounded corners=8pt]
			\draw[shorten <= -10pt]
			(aux2) --
			++(225:3) coordinate[pos=0.45] (c) --
			++(-45:3.1);
			\draw
			(aux2) --
			(c) --
			++(135:2.5) --
			++(45:2.5) --
			++(-45:2.5) coordinate[pos=0.3] (d);   
			\draw 
			(d) -- +(45:1);
		\end{scope}
	\end{tikzpicture}
}

% Se crea el comando maketitle asociado al paquete.
\renewcommand*{\maketitle}{

	\begin{titlepage}

		% Asignatura, título y subtítulo
		\vspace*{3.1cm}		
		\centering \subjectfont \subject
		\vspace*{1cm}
		
		\titlefont \doctitle
		\vspace*{1cm}
		
		\subtitlefont \docsubtitle
		\null\vfill

		%\normalsize\vspace{0.1in}\small{\fecha} 
		
		% Autor
		\titlepagebottom

		% Decoración
		\titlepagedecoration

	\end{titlepage}

}

\endinput